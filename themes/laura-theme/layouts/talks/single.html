{{ define "main" }}
<article class="talk-single">
    <header class="talk-header section">
        <div class="container">
            <nav class="breadcrumb" aria-label="Breadcrumb navigation">
                <ol>
                    <li><a href="{{ .Site.BaseURL }}">Home</a></li>
                    <li><a href="/talks/">Talks</a></li>
                    <li aria-current="page">{{ .Title }}</li>
                </ol>
            </nav>
            
            <div class="talk-hero">
                <h1 class="talk-title">{{ .Title | safeHTML }}</h1>
                
                <div class="talk-meta" aria-label="Talk details">
                    {{ if .Params.duration }}
                    <span class="meta-item" aria-label="Duration">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                            <circle cx="12" cy="12" r="10"/>
                            <polyline points="12,6 12,12 16,14"/>
                        </svg>
                        {{ .Params.duration }}
                    </span>
                    {{ end }}
                    
                    {{ if .Params.audience }}
                    <span class="meta-item" aria-label="Target audience">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                        </svg>
                        {{ .Params.audience }}
                    </span>
                    {{ end }}
                    
                    {{ if .Params.featured }}
                    <span class="meta-item featured" aria-label="Featured talk">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                            <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/>
                        </svg>
                        Featured Talk
                    </span>
                    {{ end }}
                    
                    <time datetime="{{ .Date.Format "2006-01-02" }}" class="meta-item" aria-label="Last updated">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                            <line x1="16" y1="2" x2="16" y2="6"/>
                            <line x1="8" y1="2" x2="8" y2="6"/>
                            <line x1="3" y1="10" x2="21" y2="10"/>
                        </svg>
                        Updated {{ .Date.Format "January 2, 2006" }}
                    </time>
                </div>
                
                {{ if .Params.summary }}
                <div class="talk-summary">
                    <p class="lead">{{ .Params.summary }}</p>
                </div>
                {{ end }}
            </div>
        </div>
    </header>
    
    <div class="talk-content section">
        <div class="container">
            <div class="content-grid">
                <main class="talk-main" role="main">
                    {{ if .Params.takeaways }}
                    <section class="takeaways-section" aria-labelledby="takeaways-title">
                        <h2 id="takeaways-title">What You'll Learn</h2>
                        <ul class="takeaways-list" role="list">
                            {{ range .Params.takeaways }}
                            <li>{{ . }}</li>
                            {{ end }}
                        </ul>
                    </section>
                    {{ end }}
                    
                    <section class="talk-description" aria-labelledby="description-title">
                        <h2 id="description-title">Talk Description</h2>
                        <div class="prose">
                            {{ .Content }}
                        </div>
                    </section>
                </main>
                
                <aside class="talk-sidebar" role="complementary" aria-label="Talk information">
                    <div class="sidebar-content">
                        <div class="cta-section">
                            <h3>Book This Talk</h3>
                            <p>Interested in having Laura present this talk at your event?</p>
                            <a href="#contact" class="cta-button">
                                Get In Touch
                            </a>
                        </div>
                        
                        {{ if .Params.tags }}
                        <div class="tags-section">
                            <h3>Topics Covered</h3>
                            <div class="tags-list" role="list" aria-label="Talk topics">
                                {{ range .Params.tags }}
                                <span class="tag" role="listitem">{{ . }}</span>
                                {{ end }}
                            </div>
                        </div>
                        {{ end }}
                        
                        <div class="share-section">
                            <h3>Share This Talk</h3>
                            <div class="share-buttons" role="group" aria-label="Share this talk">
                                <a href="https://twitter.com/intent/tweet?text={{ .Title | urlquery }}&url={{ .Permalink | urlquery }}" 
                                   class="share-button twitter" 
                                   target="_blank" 
                                   rel="noopener noreferrer"
                                   aria-label="Share on Twitter (opens in new window)">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                        <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                                    </svg>
                                    Twitter
                                </a>
                                
                                <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ .Permalink | urlquery }}" 
                                   class="share-button linkedin" 
                                   target="_blank" 
                                   rel="noopener noreferrer"
                                   aria-label="Share on LinkedIn (opens in new window)">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                                    </svg>
                                    LinkedIn
                                </a>
                                
                                <button class="share-button copy-link" 
                                        onclick="copyToClipboard('{{ .Permalink }}')"
                                        aria-label="Copy link to clipboard">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                    </svg>
                                    Copy Link
                                </button>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </div>
    
    <!-- Related Talks -->
    {{ $related := .Site.RegularPages.Related . | first 3 }}
    {{ if $related }}
    <section class="related-talks section" aria-labelledby="related-title">
        <div class="container">
            <h2 id="related-title">Related Talks</h2>
            <div class="related-grid">
                {{ range $related }}
                <article class="related-card">
                    <h3 class="related-title">
                        <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                    </h3>
                    {{ if .Params.summary }}
                    <p class="related-summary">{{ .Params.summary }}</p>
                    {{ end }}
                    <div class="related-meta">
                        {{ if .Params.duration }}
                        <span class="duration">{{ .Params.duration }}</span>
                        {{ end }}
                        {{ if .Params.audience }}
                        <span class="audience">{{ .Params.audience }}</span>
                        {{ end }}
                    </div>
                </article>
                {{ end }}
            </div>
        </div>
    </section>
    {{ end }}
</article>

<style>
/* Talk single page styles */
.talk-single .talk-header {
    background: linear-gradient(135deg, var(--color-gray-50) 0%, var(--color-gray-100) 100%);
    padding: var(--spacing-2xl) 0 var(--spacing-3xl);
}

.breadcrumb {
    margin-bottom: var(--spacing-xl);
}

.breadcrumb ol {
    display: flex;
    list-style: none;
    gap: var(--spacing-sm);
    margin: 0;
    padding: 0;
    font-size: var(--font-size-sm);
}

.breadcrumb li:not(:last-child)::after {
    content: '›';
    margin-left: var(--spacing-sm);
    color: var(--color-gray-400);
}

.breadcrumb a {
    color: var(--color-gray-600);
    text-decoration: none;
}

.breadcrumb a:hover {
    color: var(--color-primary);
}

.breadcrumb li[aria-current="page"] {
    color: var(--color-text);
    font-weight: 500;
}

.talk-hero {
    max-width: 800px;
}

.talk-title {
    font-size: var(--font-size-4xl);
    font-weight: 700;
    margin-bottom: var(--spacing-lg);
    color: var(--color-text);
    line-height: 1.2;
}

.talk-meta {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-xl);
    font-size: var(--font-size-base);
    color: var(--color-gray-600);
}

.meta-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.meta-item.featured {
    color: var(--color-callout);
    font-weight: 600;
}

.talk-summary .lead {
    font-size: var(--font-size-xl);
    line-height: 1.5;
    color: var(--color-gray-700);
    margin: 0;
}

.talk-content {
    padding-top: 0;
}

.content-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--spacing-3xl);
}

@media (min-width: 1024px) {
    .content-grid {
        grid-template-columns: 2fr 1fr;
    }
}

.talk-main {
    max-width: none;
}

.takeaways-section {
    background: var(--color-gray-50);
    padding: var(--spacing-2xl);
    border-radius: var(--radius-xl);
    margin-bottom: var(--spacing-3xl);
}

.takeaways-section h2 {
    color: var(--color-primary);
    margin-bottom: var(--spacing-lg);
}

.takeaways-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.takeaways-list li {
    position: relative;
    padding-left: var(--spacing-xl);
    margin-bottom: var(--spacing-md);
    font-size: var(--font-size-lg);
    line-height: 1.6;
}

.takeaways-list li::before {
    content: '✓';
    position: absolute;
    left: 0;
    top: 0;
    color: var(--color-primary);
    font-weight: bold;
    font-size: var(--font-size-xl);
}

.talk-description h2 {
    margin-bottom: var(--spacing-lg);
}

.prose {
    line-height: 1.7;
    font-size: var(--font-size-lg);
    color: var(--color-text);
}

.prose h3 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-lg);
    color: var(--color-primary);
}

.prose h4 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-md);
}

.prose p {
    margin-bottom: var(--spacing-lg);
}

.prose ul, .prose ol {
    margin-bottom: var(--spacing-lg);
    padding-left: var(--spacing-xl);
}

.prose li {
    margin-bottom: var(--spacing-sm);
}

.talk-sidebar {
    position: sticky;
    top: var(--spacing-xl);
    height: fit-content;
}

.sidebar-content > div {
    background: white;
    padding: var(--spacing-xl);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-md);
    margin-bottom: var(--spacing-xl);
}

.sidebar-content h3 {
    font-size: var(--font-size-lg);
    margin-bottom: var(--spacing-md);
    color: var(--color-primary);
}

.cta-section p {
    color: var(--color-gray-600);
    margin-bottom: var(--spacing-lg);
}

.tags-list {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
}

.tag {
    background: var(--color-gray-100);
    color: var(--color-gray-700);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--radius-md);
    font-size: var(--font-size-sm);
    font-weight: 500;
}

.share-buttons {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.share-button {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-sm) var(--spacing-md);
    border: 1px solid var(--color-gray-300);
    border-radius: var(--radius-md);
    background: white;
    color: var(--color-gray-700);
    text-decoration: none;
    font-size: var(--font-size-sm);
    transition: all var(--transition-fast);
    cursor: pointer;
}

.share-button:hover,
.share-button:focus {
    border-color: var(--color-primary);
    background: var(--color-gray-50);
    color: var(--color-primary);
}

.share-button.twitter:hover,
.share-button.twitter:focus {
    border-color: #1da1f2;
    background: #1da1f2;
    color: white;
}

.share-button.linkedin:hover,
.share-button.linkedin:focus {
    border-color: #0077b5;
    background: #0077b5;
    color: white;
}

.related-talks {
    background: var(--color-gray-50);
}

.related-talks h2 {
    text-align: center;
    margin-bottom: var(--spacing-2xl);
}

.related-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--spacing-xl);
}

@media (min-width: 768px) {
    .related-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (min-width: 1024px) {
    .related-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}

.related-card {
    background: white;
    padding: var(--spacing-xl);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-md);
    transition: transform var(--transition-fast), box-shadow var(--transition-fast);
}

.related-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.related-title {
    margin-bottom: var(--spacing-md);
    font-size: var(--font-size-lg);
}

.related-title a {
    color: var(--color-text);
    text-decoration: none;
}

.related-title a:hover {
    color: var(--color-primary);
}

.related-summary {
    color: var(--color-gray-600);
    margin-bottom: var(--spacing-md);
    line-height: 1.6;
}

.related-meta {
    display: flex;
    gap: var(--spacing-md);
    font-size: var(--font-size-sm);
    color: var(--color-gray-500);
}

/* Mobile optimizations */
@media (max-width: 767px) {
    .talk-title {
        font-size: var(--font-size-3xl);
    }
    
    .talk-meta {
        flex-direction: column;
        gap: var(--spacing-sm);
    }
    
    .talk-summary .lead {
        font-size: var(--font-size-lg);
    }
    
    .takeaways-section {
        padding: var(--spacing-lg);
    }
    
    .prose {
        font-size: var(--font-size-base);
    }
    
    .sidebar-content > div {
        padding: var(--spacing-lg);
    }
    
    .talk-sidebar {
        position: static;
    }
}

/* Print styles */
@media print {
    .breadcrumb,
    .talk-sidebar,
    .related-talks {
        display: none;
    }
    
    .content-grid {
        grid-template-columns: 1fr;
    }
}
</style>

<script>
function copyToClipboard(text) {
    if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(text).then(function() {
            // Visual feedback
            const button = event.target.closest('.copy-link');
            const originalText = button.textContent;
            button.textContent = 'Copied!';
            button.style.backgroundColor = 'var(--color-primary)';
            button.style.color = 'white';
            
            setTimeout(function() {
                button.innerHTML = originalText;
                button.style.backgroundColor = '';
                button.style.color = '';
            }, 2000);
        });
    } else {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        try {
            document.execCommand('copy');
            // Same visual feedback as above
            const button = event.target.closest('.copy-link');
            const originalText = button.textContent;
            button.textContent = 'Copied!';
            button.style.backgroundColor = 'var(--color-primary)';
            button.style.color = 'white';
            
            setTimeout(function() {
                button.innerHTML = originalText;
                button.style.backgroundColor = '';
                button.style.color = '';
            }, 2000);
        } catch (err) {
            console.error('Failed to copy text: ', err);
        }
        document.body.removeChild(textArea);
    }
}
</script>
{{ end }}