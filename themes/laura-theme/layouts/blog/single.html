{{ define "main" }}
<article class="blog-single">
    <header class="blog-header section">
        <div class="container">
            <nav class="breadcrumb" aria-label="Breadcrumb navigation">
                <ol>
                    <li><a href="{{ .Site.BaseURL }}">Home</a></li>
                    <li><a href="/blog/">Blog</a></li>
                    <li aria-current="page">{{ .Title }}</li>
                </ol>
            </nav>
            
            <div class="blog-hero">
                {{ if .Params.featured_image }}
                <div class="featured-image">
                    <img src="{{ .Params.featured_image | relURL }}" 
                         alt="{{ .Params.featured_image_alt | default "Blog post featured image" }}" 
                         loading="eager">
                </div>
                {{ end }}
                
                <div class="blog-info">
                    <h1 class="blog-title">{{ .Title }}</h1>
                    
                    <div class="blog-meta" aria-label="Post details">
                        <time datetime="{{ .Date.Format "2006-01-02" }}" class="meta-item" aria-label="Published date">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                <line x1="16" y1="2" x2="16" y2="6"/>
                                <line x1="8" y1="2" x2="8" y2="6"/>
                                <line x1="3" y1="10" x2="21" y2="10"/>
                            </svg>
                            {{ .Date.Format "January 2, 2006" }}
                        </time>
                        
                        <span class="meta-item" aria-label="Reading time">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                <circle cx="12" cy="12" r="10"/>
                                <polyline points="12,6 12,12 16,14"/>
                            </svg>
                            {{ .ReadingTime }} minute read
                        </span>
                        
                        {{ if .Params.categories }}
                        <div class="categories" aria-label="Post categories">
                            {{ range .Params.categories }}
                            <span class="category">{{ . }}</span>
                            {{ end }}
                        </div>
                        {{ end }}
                    </div>
                    
                    {{ if .Params.summary }}
                    <div class="blog-summary">
                        <p class="lead">{{ .Params.summary }}</p>
                    </div>
                    {{ end }}
                </div>
            </div>
        </div>
    </header>
    
    <div class="blog-content section">
        <div class="container">
            <div class="content-grid">
                <main class="blog-main" role="main">
                    <div class="prose" role="article">
                        {{ .Content }}
                    </div>
                    
                    {{ if .Params.tags }}
                    <footer class="blog-footer" role="contentinfo">
                        <div class="tags-section">
                            <h3>Tags</h3>
                            <div class="tags-list" role="list" aria-label="Post tags">
                                {{ range .Params.tags }}
                                <span class="tag" role="listitem">#{{ . }}</span>
                                {{ end }}
                            </div>
                        </div>
                    </footer>
                    {{ end }}
                </main>
                
                <aside class="blog-sidebar" role="complementary" aria-label="Post information">
                    <div class="sidebar-content">
                        <div class="author-section">
                            <h3>About Laura</h3>
                            <div class="author-info">
                                <img src="/images/laura-avatar.jpg" 
                                     alt="Laura Anthony" 
                                     class="author-avatar"
                                     loading="lazy">
                                <div class="author-text">
                                    <p>Laura Anthony is a speaker and accessibility advocate with over a decade of experience helping organizations create inclusive digital experiences.</p>
                                    <a href="/about/" class="author-link">Learn more about Laura</a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="newsletter-section">
                            <h3>Stay Updated</h3>
                            <p>Get the latest insights on accessibility and inclusive design delivered to your inbox.</p>
                            <form class="newsletter-form" action="https://formspree.io/f/{{ .Site.Params.formspreeId }}" method="post">
                                <input type="hidden" name="_subject" value="Newsletter Subscription">
                                <div class="form-group">
                                    <label for="newsletter-email" class="sr-only">Email address</label>
                                    <input type="email" 
                                           id="newsletter-email" 
                                           name="email" 
                                           placeholder="Your email address" 
                                           required 
                                           aria-required="true">
                                </div>
                                <button type="submit" class="newsletter-button">Subscribe</button>
                            </form>
                        </div>
                        
                        <div class="share-section">
                            <h3>Share This Post</h3>
                            <div class="share-buttons" role="group" aria-label="Share this post">
                                <a href="https://twitter.com/intent/tweet?text={{ .Title | urlquery }}&url={{ .Permalink | urlquery }}" 
                                   class="share-button twitter" 
                                   target="_blank" 
                                   rel="noopener noreferrer"
                                   aria-label="Share on Twitter (opens in new window)">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                        <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                                    </svg>
                                    Twitter
                                </a>
                                
                                <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ .Permalink | urlquery }}" 
                                   class="share-button linkedin" 
                                   target="_blank" 
                                   rel="noopener noreferrer"
                                   aria-label="Share on LinkedIn (opens in new window)">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                                    </svg>
                                    LinkedIn
                                </a>
                                
                                <button class="share-button copy-link" 
                                        onclick="copyToClipboard('{{ .Permalink }}')"
                                        aria-label="Copy link to clipboard">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                    </svg>
                                    Copy Link
                                </button>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </div>
    
    <!-- Related Posts -->
    {{ $related := .Site.RegularPages.Related . | first 3 }}
    {{ if $related }}
    <section class="related-posts section" aria-labelledby="related-title">
        <div class="container">
            <h2 id="related-title">Related Articles</h2>
            <div class="related-grid">
                {{ range $related }}
                <article class="related-card">
                    {{ if .Params.featured_image }}
                    <div class="related-image">
                        <img src="{{ .Params.featured_image | relURL }}" 
                             alt="{{ .Params.featured_image_alt | default "Related post image" }}" 
                             loading="lazy">
                    </div>
                    {{ end }}
                    
                    <div class="related-content">
                        <h3 class="related-title">
                            <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                        </h3>
                        
                        {{ if .Params.summary }}
                        <p class="related-summary">{{ .Params.summary }}</p>
                        {{ else if .Summary }}
                        <p class="related-summary">{{ .Summary }}</p>
                        {{ end }}
                        
                        <div class="related-meta">
                            <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "January 2, 2006" }}</time>
                            <span class="read-time">{{ .ReadingTime }} min read</span>
                        </div>
                    </div>
                </article>
                {{ end }}
            </div>
        </div>
    </section>
    {{ end }}
</article>

<style>
/* Blog single page styles */
.blog-single .blog-header {
    background: linear-gradient(135deg, var(--color-gray-50) 0%, var(--color-gray-100) 100%);
    padding: var(--spacing-2xl) 0 var(--spacing-3xl);
}

.breadcrumb {
    margin-bottom: var(--spacing-xl);
}

.breadcrumb ol {
    display: flex;
    list-style: none;
    gap: var(--spacing-sm);
    margin: 0;
    padding: 0;
    font-size: var(--font-size-sm);
}

.breadcrumb li:not(:last-child)::after {
    content: '›';
    margin-left: var(--spacing-sm);
    color: var(--color-gray-400);
}

.breadcrumb a {
    color: var(--color-gray-600);
    text-decoration: none;
}

.breadcrumb a:hover {
    color: var(--color-primary);
}

.breadcrumb li[aria-current="page"] {
    color: var(--color-text);
    font-weight: 500;
}

.blog-hero {
    max-width: 800px;
}

.featured-image {
    width: 100%;
    height: 300px;
    margin-bottom: var(--spacing-xl);
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-lg);
}

.featured-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.blog-title {
    font-size: var(--font-size-4xl);
    font-weight: 700;
    margin-bottom: var(--spacing-lg);
    color: var(--color-text);
    line-height: 1.2;
}

.blog-meta {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-xl);
    font-size: var(--font-size-base);
    color: var(--color-gray-600);
    align-items: center;
}

.meta-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.categories {
    display: flex;
    gap: var(--spacing-xs);
}

.category {
    background: var(--color-primary);
    color: white;
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-xs);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.blog-summary .lead {
    font-size: var(--font-size-xl);
    line-height: 1.5;
    color: var(--color-gray-700);
    margin: 0;
}

.blog-content {
    padding-top: 0;
}

.content-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--spacing-3xl);
}

@media (min-width: 1024px) {
    .content-grid {
        grid-template-columns: 2fr 1fr;
    }
}

.blog-main {
    max-width: none;
}

.prose {
    line-height: 1.7;
    font-size: var(--font-size-lg);
    color: var(--color-text);
}

.prose h2 {
    margin-top: var(--spacing-3xl);
    margin-bottom: var(--spacing-lg);
    color: var(--color-primary);
    font-size: var(--font-size-2xl);
}

.prose h3 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-lg);
    color: var(--color-text);
    font-size: var(--font-size-xl);
}

.prose h4 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-md);
    font-size: var(--font-size-lg);
}

.prose p {
    margin-bottom: var(--spacing-lg);
}

.prose ul, .prose ol {
    margin-bottom: var(--spacing-lg);
    padding-left: var(--spacing-xl);
}

.prose li {
    margin-bottom: var(--spacing-sm);
}

.prose blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-lg);
    margin: var(--spacing-xl) 0;
    font-style: italic;
    color: var(--color-gray-600);
    background: var(--color-gray-50);
    padding: var(--spacing-lg);
    border-radius: 0 var(--radius-md) var(--radius-md) 0;
}

.prose img {
    width: 100%;
    height: auto;
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-md);
    margin: var(--spacing-xl) 0;
}

.prose code {
    background: var(--color-gray-100);
    padding: 2px 6px;
    border-radius: var(--radius-sm);
    font-size: 0.9em;
    color: var(--color-callout);
}

.prose pre {
    background: var(--color-gray-900);
    color: var(--color-gray-100);
    padding: var(--spacing-lg);
    border-radius: var(--radius-lg);
    overflow-x: auto;
    margin: var(--spacing-xl) 0;
}

.prose pre code {
    background: none;
    padding: 0;
    color: inherit;
}

.blog-footer {
    margin-top: var(--spacing-3xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-gray-200);
}

.tags-section h3 {
    margin-bottom: var(--spacing-md);
    color: var(--color-primary);
}

.tags-list {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
}

.tag {
    background: var(--color-gray-100);
    color: var(--color-gray-700);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--radius-md);
    font-size: var(--font-size-sm);
    font-weight: 500;
}

.blog-sidebar {
    position: sticky;
    top: var(--spacing-xl);
    height: fit-content;
}

.sidebar-content > div {
    background: white;
    padding: var(--spacing-xl);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-md);
    margin-bottom: var(--spacing-xl);
}

.sidebar-content h3 {
    font-size: var(--font-size-lg);
    margin-bottom: var(--spacing-md);
    color: var(--color-primary);
}

.author-info {
    display: flex;
    gap: var(--spacing-md);
    align-items: flex-start;
}

.author-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    object-fit: cover;
    flex-shrink: 0;
}

.author-text p {
    color: var(--color-gray-600);
    margin-bottom: var(--spacing-sm);
    font-size: var(--font-size-sm);
    line-height: 1.5;
}

.author-link {
    color: var(--color-primary);
    text-decoration: none;
    font-size: var(--font-size-sm);
    font-weight: 500;
}

.author-link:hover {
    text-decoration: underline;
}

.newsletter-section p {
    color: var(--color-gray-600);
    margin-bottom: var(--spacing-lg);
    font-size: var(--font-size-sm);
}

.newsletter-form {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.newsletter-form input {
    padding: var(--spacing-sm) var(--spacing-md);
    border: 2px solid var(--color-gray-300);
    border-radius: var(--radius-md);
    font-size: var(--font-size-sm);
    transition: border-color var(--transition-fast);
}

.newsletter-form input:focus {
    outline: none;
    border-color: var(--color-primary);
}

.newsletter-button {
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--color-primary);
    color: white;
    border: none;
    border-radius: var(--radius-md);
    font-size: var(--font-size-sm);
    font-weight: 500;
    cursor: pointer;
    transition: background var(--transition-fast);
}

.newsletter-button:hover {
    background: var(--color-secondary);
}

.share-buttons {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.share-button {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-sm) var(--spacing-md);
    border: 1px solid var(--color-gray-300);
    border-radius: var(--radius-md);
    background: white;
    color: var(--color-gray-700);
    text-decoration: none;
    font-size: var(--font-size-sm);
    transition: all var(--transition-fast);
    cursor: pointer;
}

.share-button:hover,
.share-button:focus {
    border-color: var(--color-primary);
    background: var(--color-gray-50);
    color: var(--color-primary);
}

.share-button.twitter:hover,
.share-button.twitter:focus {
    border-color: #1da1f2;
    background: #1da1f2;
    color: white;
}

.share-button.linkedin:hover,
.share-button.linkedin:focus {
    border-color: #0077b5;
    background: #0077b5;
    color: white;
}

.related-posts {
    background: var(--color-gray-50);
}

.related-posts h2 {
    text-align: center;
    margin-bottom: var(--spacing-2xl);
}

.related-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--spacing-xl);
}

@media (min-width: 768px) {
    .related-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (min-width: 1024px) {
    .related-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}

.related-card {
    background: white;
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-md);
    transition: transform var(--transition-fast), box-shadow var(--transition-fast);
}

.related-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.related-image {
    width: 100%;
    height: 150px;
    overflow: hidden;
}

.related-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.related-content {
    padding: var(--spacing-lg);
}

.related-title {
    margin-bottom: var(--spacing-sm);
    font-size: var(--font-size-lg);
}

.related-title a {
    color: var(--color-text);
    text-decoration: none;
}

.related-title a:hover {
    color: var(--color-primary);
}

.related-summary {
    color: var(--color-gray-600);
    margin-bottom: var(--spacing-md);
    line-height: 1.5;
    font-size: var(--font-size-sm);
}

.related-meta {
    display: flex;
    justify-content: space-between;
    font-size: var(--font-size-xs);
    color: var(--color-gray-500);
}

/* Mobile optimizations */
@media (max-width: 767px) {
    .blog-title {
        font-size: var(--font-size-3xl);
    }
    
    .blog-meta {
        flex-direction: column;
        gap: var(--spacing-sm);
        align-items: flex-start;
    }
    
    .blog-summary .lead {
        font-size: var(--font-size-lg);
    }
    
    .featured-image {
        height: 200px;
    }
    
    .prose {
        font-size: var(--font-size-base);
    }
    
    .prose h2 {
        font-size: var(--font-size-xl);
    }
    
    .sidebar-content > div {
        padding: var(--spacing-lg);
    }
    
    .blog-sidebar {
        position: static;
    }
    
    .author-info {
        flex-direction: column;
        text-align: center;
    }
    
    .author-avatar {
        align-self: center;
    }
}

/* Print styles */
@media print {
    .breadcrumb,
    .blog-sidebar,
    .related-posts {
        display: none;
    }
    
    .content-grid {
        grid-template-columns: 1fr;
    }
    
    .featured-image {
        height: auto;
        max-height: 300px;
    }
}
</style>

<script>
function copyToClipboard(text) {
    if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(text).then(function() {
            // Visual feedback
            const button = event.target.closest('.copy-link');
            const originalText = button.innerHTML;
            button.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><polyline points="20,6 9,17 4,12"/></svg>Copied!';
            button.style.backgroundColor = 'var(--color-primary)';
            button.style.color = 'white';
            
            setTimeout(function() {
                button.innerHTML = originalText;
                button.style.backgroundColor = '';
                button.style.color = '';
            }, 2000);
        });
    } else {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        try {
            document.execCommand('copy');
            // Same visual feedback as above
            const button = event.target.closest('.copy-link');
            const originalText = button.innerHTML;
            button.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><polyline points="20,6 9,17 4,12"/></svg>Copied!';
            button.style.backgroundColor = 'var(--color-primary)';
            button.style.color = 'white';
            
            setTimeout(function() {
                button.innerHTML = originalText;
                button.style.backgroundColor = '';
                button.style.color = '';
            }, 2000);
        } catch (err) {
            console.error('Failed to copy text: ', err);
        }
        document.body.removeChild(textArea);
    }
}
</script>
{{ end }}